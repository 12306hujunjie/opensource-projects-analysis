# 01. FastAPIæ¶æ„å…¨æ™¯ä¸è®¾è®¡ç†å¿µ

> **æŠ€æœ¯å®šä½**: ç°ä»£Python Web APIæ¡†æ¶ | **æ ¸å¿ƒåˆ›æ–°**: ç±»å‹é©±åŠ¨å¼€å‘ | **æ¶æ„æ¨¡å¼**: ç»§æ‰¿+ç»„åˆçš„åˆ†å±‚è®¾è®¡

---

## ğŸŒŸ é¡¹ç›®æŠ€æœ¯å®šä½ä¸ä»·å€¼ä¸»å¼ 

### æ ¸å¿ƒæŠ€æœ¯é—®é¢˜
FastAPIè§£å†³çš„æ ¹æœ¬é—®é¢˜ï¼š**å¦‚ä½•è®©Pythonå¼€å‘è€…ç”¨æœ€è‡ªç„¶çš„æ–¹å¼ç¼–å†™é«˜æ€§èƒ½Web APIï¼ŒåŒæ—¶è‡ªåŠ¨è·å¾—ä¼ä¸šçº§ç‰¹æ€§ï¼Ÿ**

- **å¼€å‘ä½“éªŒé—®é¢˜**ï¼šä¼ ç»Ÿæ¡†æ¶éœ€è¦å¤§é‡é…ç½®ï¼Œå­¦ä¹ æˆæœ¬é«˜
- **æ€§èƒ½ä¸æ˜“ç”¨æ€§çŸ›ç›¾**ï¼šé«˜æ€§èƒ½æ¡†æ¶é€šå¸¸å¤æ‚ï¼Œæ˜“ç”¨æ¡†æ¶é€šå¸¸æ€§èƒ½ä¸ä½³  
- **æ–‡æ¡£ç»´æŠ¤æˆæœ¬**ï¼šAPIæ–‡æ¡£ä¸ä»£ç ä¸åŒæ­¥ï¼Œç»´æŠ¤å›°éš¾
- **ç±»å‹å®‰å…¨ç¼ºå¤±**ï¼šè¿è¡Œæ—¶æ‰èƒ½å‘ç°çš„ç±»å‹é”™è¯¯ï¼Œè°ƒè¯•å›°éš¾

### æŠ€æœ¯ä»·å€¼åˆ›æ–°
- **é›¶é…ç½®ä½“éªŒ**ï¼šåŸºäºçº¦å®šå’Œç±»å‹æ¨æ–­ï¼Œæœ€å°åŒ–æ˜¾å¼é…ç½®
- **ç±»å‹é©±åŠ¨å¼€å‘**ï¼šç¼–è¯‘æ—¶+è¿è¡Œæ—¶åŒé‡ç±»å‹ä¿éšœ  
- **è‡ªåŠ¨åŒ–å·¥å…·é“¾**ï¼šæ–‡æ¡£ç”Ÿæˆã€æ•°æ®éªŒè¯ã€IDEæ”¯æŒçš„å®Œæ•´è‡ªåŠ¨åŒ–
- **ç°ä»£å¼‚æ­¥ä¼˜å…ˆ**ï¼šåŸç”ŸASGIæ”¯æŒï¼Œé«˜å¹¶å‘æ€§èƒ½

---

## ğŸ“Š ç³»ç»Ÿæ¶æ„å…¨æ™¯å›¾

### æ•´ä½“æ¶æ„å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ FastAPI ç³»ç»Ÿæ¶æ„å…¨æ™¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚   FastAPI   â”‚ â†â”€â”€ åº”ç”¨å…¥å£ï¼Œé…ç½®ä¸­å¿ƒ                     â”‚
â”‚  â”‚  (ä¸»åº”ç”¨ç±»)  â”‚                                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚         â”‚                                                  â”‚
â”‚         â”‚ ç»§æ‰¿å…³ç³»                                          â”‚
â”‚         â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Starlette  â”‚ â—„â”€â–º â”‚   APIRouter  â”‚ â—„â”€â–º â”‚  APIRoute   â”‚ â”‚
â”‚  â”‚ (ASGIåŸºç¡€)  â”‚     â”‚   (è·¯ç”±ç³»ç»Ÿ)  â”‚     â”‚ (è·¯ç”±å¤„ç†å™¨) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                     â”‚                    â”‚      â”‚
â”‚         â”‚                     â”‚                    â”‚      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Middleware  â”‚     â”‚ Dependencies â”‚     â”‚   Request   â”‚ â”‚
â”‚  â”‚   Stack     â”‚     â”‚   System     â”‚     â”‚  Handler    â”‚ â”‚
â”‚  â”‚  (è¯·æ±‚ç®¡é“)  â”‚     â”‚  (ä¾èµ–æ³¨å…¥)   â”‚     â”‚  (ä¸šåŠ¡é€»è¾‘)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                     â”‚                    â”‚      â”‚
â”‚         â”‚                     â”‚                    â”‚      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Pydantic  â”‚     â”‚    OpenAPI   â”‚     â”‚  Exception  â”‚ â”‚
â”‚  â”‚ (æ•°æ®éªŒè¯)   â”‚     â”‚ (æ–‡æ¡£ç”Ÿæˆ)    â”‚     â”‚  Handlers   â”‚ â”‚
â”‚  â”‚ & åºåˆ—åŒ–     â”‚     â”‚ & APIè§„èŒƒ    â”‚     â”‚  (å¼‚å¸¸å¤„ç†) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶èŒè´£åˆ†æ

#### **FastAPIä¸»ç±»** (`fastapi/applications.py:48`)
```python
class FastAPI(Starlette):
    """åº”ç”¨å…¥å£å’Œé…ç½®ä¸­å¿ƒ"""
    def __init__(self, ...):
        # é…ç½®ç®¡ç†ï¼šOpenAPIå…ƒæ•°æ®ã€æ–‡æ¡£è·¯å¾„ã€è°ƒè¯•æ¨¡å¼ç­‰
        self.title = title
        self.version = version  
        self.openapi_url = openapi_url
        
        # ç»„ä»¶ç»„è£…ï¼šè·¯ç”±å™¨ã€å¼‚å¸¸å¤„ç†ã€ä¸­é—´ä»¶æ ˆ
        self.router = routing.APIRouter(...)
        self.exception_handlers = {...}
        self.user_middleware = [...]
        
        # è‡ªåŠ¨åŒ–è®¾ç½®ï¼šæ–‡æ¡£è·¯ç”±ã€ä¾èµ–ç³»ç»Ÿ
        self.setup()  # é›¶é…ç½®çš„æ ¸å¿ƒ
```

**è®¾è®¡äº®ç‚¹**ï¼š
- **ç»§æ‰¿Starlette**ï¼šå¤ç”¨æˆç†ŸASGIå®ç°ï¼Œä¸“æ³¨äºAPIç‰¹æ€§
- **ç»„åˆæ¨¡å¼**ï¼šé€šè¿‡ç»„åˆAPIRouterå®ç°åŠŸèƒ½æ‰©å±•
- **é…ç½®é©±åŠ¨**ï¼šä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œä½†æœ‰åˆç†é»˜è®¤å€¼

#### **è·¯ç”±ç³»ç»Ÿ** (`fastapi/routing.py`)
```python
class APIRouter(Starlette.Router):
    """å±‚æ¬¡åŒ–è·¯ç”±ç®¡ç†å™¨"""
    def add_api_route(self, path, endpoint, ...):
        # è·¯ç”±æ³¨å†Œ + ä¾èµ–åˆ†æ + OpenAPIå…ƒæ•°æ®æå–
        dependant = get_dependant(path=path, call=endpoint, ...)
        route = APIRoute(path, endpoint, dependant=dependant, ...)
        self.routes.append(route)

class APIRoute(Starlette.Route):
    """å•ä¸ªè·¯ç”±çš„å®Œæ•´å¤„ç†é€»è¾‘"""
    def __init__(self, path, endpoint, ...):
        self.dependant = dependant
        self.request_handler = get_request_handler(
            dependant=dependant, 
            body_field=body_field
        )
```

**æ¶æ„åˆ›æ–°**ï¼š
- **è·¯ç”±+ä¾èµ–ä¸€ä½“åŒ–**ï¼šè·¯ç”±æ³¨å†Œæ—¶å³å®Œæˆä¾èµ–åˆ†æ
- **å»¶è¿Ÿæ„å»º**ï¼šè¯·æ±‚å¤„ç†å™¨æŒ‰éœ€æ„å»ºï¼Œä¼˜åŒ–å¯åŠ¨æ€§èƒ½
- **å…ƒæ•°æ®æå–**ï¼šè‡ªåŠ¨ä»å‡½æ•°ç­¾åæå–OpenAPIä¿¡æ¯

---

## ğŸ—ï¸ æ ¸å¿ƒè®¾è®¡ç†å¿µæ·±åº¦è§£æ

### 1. ç±»å‹é©±åŠ¨æ¶æ„è®¾è®¡

#### ç±»å‹ç³»ç»Ÿçš„ä¸‰å±‚åº”ç”¨
```python
# L1: å‡½æ•°ç­¾åç±»å‹æç¤º
@app.get("/users/{user_id}")
def get_user(user_id: int, q: Optional[str] = None) -> UserModel:
    pass

# L2: ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ (mypy/IDE)
# âœ… IDEè‡ªåŠ¨å®Œæˆå’Œç±»å‹é”™è¯¯æ£€æŸ¥
# âœ… é™æ€åˆ†æå·¥å…·é›†æˆ

# L3: è¿è¡Œæ—¶ç±»å‹éªŒè¯å’Œè½¬æ¢
# âœ… è‡ªåŠ¨å‚æ•°éªŒè¯: user_idå¿…é¡»æ˜¯int
# âœ… è‡ªåŠ¨æŸ¥è¯¢å‚æ•°è§£æ: qä»URL queryæå–
# âœ… è‡ªåŠ¨å“åº”åºåˆ—åŒ–: UserModel â†’ JSON
```

#### ç±»å‹æ¨æ–­å¼•æ“æ ¸å¿ƒç®—æ³•
```python
def analyze_param(param_name: str, annotation: Any, default: Any) -> ParamSource:
    """ç±»å‹é©±åŠ¨çš„å‚æ•°æ¥æºæ¨æ–­"""
    
    # è§„åˆ™1: è·¯å¾„å‚æ•°æ£€æµ‹
    if "{" + param_name + "}" in current_path:
        return PathParam(param_name, annotation)
    
    # è§„åˆ™2: ç‰¹æ®Šç±»å‹è¯†åˆ«
    if annotation in [Request, WebSocket, BackgroundTasks]:
        return SpecialParam(param_name, annotation)
    
    # è§„åˆ™3: Pydanticæ¨¡å‹ â†’ è¯·æ±‚ä½“
    if is_pydantic_model(annotation):
        return BodyParam(param_name, annotation)
    
    # è§„åˆ™4: é»˜è®¤æŸ¥è¯¢å‚æ•°
    return QueryParam(param_name, annotation, default)
```

**è®¾è®¡å·§æ€**ï¼š
- **é›¶å­¦ä¹ æˆæœ¬**ï¼šå¼€å‘è€…æ— éœ€å­¦ä¹ æ–°è¯­æ³•ï¼Œä½¿ç”¨æ ‡å‡†Pythonç±»å‹
- **æ™ºèƒ½æ¨æ–­**ï¼šåŸºäºä¸Šä¸‹æ–‡è‡ªåŠ¨æ¨æ–­å‚æ•°æ¥æº
- **æ¸è¿›å¢å¼º**ï¼šå¯é€‰çš„æ˜¾å¼é…ç½®è¦†ç›–è‡ªåŠ¨æ¨æ–­

### 2. é›¶é…ç½®ç†å¿µçš„æŠ€æœ¯å®ç°

#### setup()æ–¹æ³•çš„è‡ªåŠ¨åŒ–é­”æ³•
```python
def setup(self) -> None:
    """é›¶é…ç½®çš„æ ¸å¿ƒå®ç°"""
    if self.openapi_url:
        # è‡ªåŠ¨åˆ›å»ºOpenAPI JSONç«¯ç‚¹
        self.add_route(self.openapi_url, self.openapi_handler)
    
    if self.docs_url:
        # è‡ªåŠ¨åˆ›å»ºSwagger UIæ–‡æ¡£
        self.add_route(self.docs_url, self.swagger_ui_handler)
    
    if self.redoc_url:
        # è‡ªåŠ¨åˆ›å»ºReDocæ–‡æ¡£  
        self.add_route(self.redoc_url, self.redoc_handler)
```

#### çº¦å®šä¼˜äºé…ç½®çš„è®¾è®¡æ¨¡å¼
```python
# çº¦å®šï¼šè·¯å¾„å‚æ•°è‡ªåŠ¨è¯†åˆ«
@app.get("/users/{user_id}")  # user_idè‡ªåŠ¨è¯†åˆ«ä¸ºè·¯å¾„å‚æ•°

# çº¦å®šï¼šHTTPæ–¹æ³•ä¸å‡½æ•°åæ˜ å°„
@app.get(...)    # GETè¯·æ±‚
@app.post(...)   # POSTè¯·æ±‚

# çº¦å®šï¼šå“åº”ç±»å‹è‡ªåŠ¨æ¨æ–­
def get_user(...) -> UserModel:  # è¿”å›ç±»å‹è‡ªåŠ¨ç”¨äºOpenAPIæ–‡æ¡£
    pass
```

### 3. ç»§æ‰¿+ç»„åˆçš„æ¶æ„æ¨¡å¼

#### ç»§æ‰¿å…³ç³»è®¾è®¡åˆ†æ
```python
FastAPI(Starlette)
â”‚
â”œâ”€ ç»§æ‰¿è·å¾—: ASGIåè®®å®ç°ã€ä¸­é—´ä»¶æ ˆã€è·¯ç”±åŸºç¡€
â”œâ”€ æ‰©å±•æ·»åŠ : ä¾èµ–æ³¨å…¥ã€è‡ªåŠ¨æ–‡æ¡£ã€ç±»å‹éªŒè¯
â””â”€ é‡å†™å®šåˆ¶: è·¯ç”±å¤„ç†ã€å¼‚å¸¸å¤„ç†ã€åº”ç”¨è®¾ç½®
```

**ç»§æ‰¿vsç»„åˆæƒè¡¡**ï¼š
- **é€‰æ‹©ç»§æ‰¿StarletteåŸå› **ï¼š
  - å¤ç”¨æˆç†Ÿç¨³å®šçš„ASGIå®ç°
  - è·å¾—å®Œæ•´çš„ä¸­é—´ä»¶ç”Ÿæ€
  - å‡å°‘é‡å¤å¼€å‘ï¼Œä¸“æ³¨APIç‰¹æ€§
- **ç»„åˆAPIRouteråŸå› **ï¼š
  - æ”¯æŒè·¯ç”±æ¨¡å—åŒ–å’ŒåµŒå¥—
  - ä¾¿äºæ‰©å±•è·¯ç”±åŠŸèƒ½
  - æ¸…æ™°çš„èŒè´£åˆ†ç¦»

#### ç»„ä»¶åä½œæœºåˆ¶
```python
# åˆå§‹åŒ–æ—¶çš„ç»„ä»¶è£…é…
self.router = APIRouter(
    dependency_overrides_provider=self,  # ä¾èµ–æ³¨å…¥é›†æˆ
    default_response_class=self.default_response_class,
    exception_handlers=self.exception_handlers,
)

# è¯·æ±‚å¤„ç†æ—¶çš„åä½œæµç¨‹
async def __call__(self, scope, receive, send):
    # 1. ASGIåè®®å¤„ç† (ç»§æ‰¿è‡ªStarlette)
    # 2. è·¯ç”±åˆ†å‘ (å§”æ‰˜ç»™APIRouter)  
    # 3. ä¾èµ–æ³¨å…¥ (é€šè¿‡dependency_overrides_provider)
    # 4. ä¸šåŠ¡é€»è¾‘æ‰§è¡Œ
    pass
```

---

## âš–ï¸ æŠ€æœ¯æ ˆé›†æˆä¸æ¶æ„é€‰æ‹©

### Starlette + Pydanticçš„å®Œç¾ç»“åˆ

#### æŠ€æœ¯æ ˆé€‰æ‹©çŸ©é˜µ
| ç»„ä»¶ | é€‰æ‹©æ–¹æ¡ˆ | æ›¿ä»£æ–¹æ¡ˆ | é€‰æ‹©ç†ç”± | é›†æˆæ–¹å¼ |
|------|---------|---------|----------|----------|
| **ASGIåŸºç¡€** | Starlette | Quart, aiohttp | æˆç†Ÿç¨³å®š+ç”Ÿæ€å®Œæ•´ | ç»§æ‰¿é›†æˆ |
| **æ•°æ®éªŒè¯** | Pydantic | Marshmallow, Cerberus | æ€§èƒ½+ç±»å‹é›†æˆ | ç»„åˆé›†æˆ |
| **ç±»å‹ç³»ç»Ÿ** | Python 3.6+ | æ—  | åŸç”Ÿæ”¯æŒ+å·¥å…·é“¾ | åŸç”Ÿé›†æˆ |
| **æ–‡æ¡£ç”Ÿæˆ** | OpenAPI 3.0+ | Swagger 2.0 | æ ‡å‡†åŒ–+å·¥å…·æ”¯æŒ | è‡ªåŠ¨ç”Ÿæˆ |

#### Starletteé›†æˆçš„æŠ€æœ¯æ·±åº¦
```python
class FastAPI(Starlette):
    async def __call__(self, scope: Scope, receive: Receive, send: Send):
        """ASGIåè®®å…¥å£ç‚¹"""
        if self.root_path:
            scope["root_path"] = self.root_path  # ä»£ç†æ”¯æŒ
        await super().__call__(scope, receive, send)  # å§”æ‰˜Starlette
```

**é›†æˆä¼˜åŠ¿**ï¼š
- **é›¶å­¦ä¹ æˆæœ¬**ï¼šç›´æ¥ç»§æ‰¿Starletteçš„ASGIå®ç°
- **ä¸­é—´ä»¶å…¼å®¹**ï¼šå®Œå…¨å…¼å®¹Starletteä¸­é—´ä»¶ç”Ÿæ€
- **æ€§èƒ½ç»§æ‰¿**ï¼šè·å¾—Starletteçš„é«˜æ€§èƒ½åŸºç¡€

#### Pydanticé›†æˆçš„æ•°æ®æµ
```python
# 1. è¯·æ±‚æ•°æ®éªŒè¯
request_body = await request.json()
validated_data = UserCreateModel(**request_body)  # PydanticéªŒè¯

# 2. ä¸šåŠ¡é€»è¾‘å¤„ç†  
result = create_user(validated_data)

# 3. å“åº”æ•°æ®åºåˆ—åŒ–
response_data = UserResponseModel.from_orm(result)
return JSONResponse(response_data.dict())  # Pydanticåºåˆ—åŒ–
```

**é›†æˆæ·±åº¦**ï¼š
- **ç±»å‹æ¡¥æ¥**ï¼šPythonç±»å‹ â†” JSON Schema â†” OpenAPI
- **éªŒè¯é“¾è·¯**ï¼šHTTPå‚æ•° â†’ Pydanticæ¨¡å‹ â†’ ä¸šåŠ¡å¯¹è±¡
- **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆ©ç”¨Pydanticçš„Cæ‰©å±•å’Œç¼“å­˜æœºåˆ¶

---

## ğŸš€ ä¸ä¸»æµæ¡†æ¶æ¶æ„å¯¹æ¯”

### æ¶æ„è®¾è®¡å¯¹æ¯”åˆ†æ

| æ¶æ„ç»´åº¦ | FastAPI | Django REST | Flask + æ‰©å±• | Express.js |
|---------|---------|-------------|--------------|------------|
| **ç»§æ‰¿ä½“ç³»** | Starletteå•ç»§æ‰¿ | Djangoå¤šå±‚ç»§æ‰¿ | Flaskç®€å•ç»§æ‰¿ | åŸç”Ÿè®¾è®¡ |
| **ç»„ä»¶ç»„ç»‡** | ç»„åˆ+ç»§æ‰¿æ··åˆ | MTVæ¨¡å¼ | æ¾æ•£æ’ä»¶ | ä¸­é—´ä»¶æ¨¡å¼ |
| **é…ç½®æ–¹å¼** | çº¦å®š+é…ç½® | é…ç½®é©±åŠ¨ | æ˜¾å¼é…ç½® | ç¼–ç¨‹é…ç½® |
| **ç±»å‹ç³»ç»Ÿ** | åŸç”Ÿç±»å‹æç¤º | åºåˆ—åŒ–å™¨ç±» | æ— åŸç”Ÿæ”¯æŒ | TypeScriptå¯é€‰ |
| **å¼‚æ­¥æ”¯æŒ** | ASGIåŸç”Ÿ | ASGIé€‚é… | æ‰©å±•æ”¯æŒ | åŸç”Ÿæ”¯æŒ |

### æŠ€æœ¯åˆ›æ–°å¯¹æ¯”

#### 1. ä¾èµ–æ³¨å…¥ç³»ç»Ÿå¯¹æ¯”
```python
# FastAPI: åŸºäºç±»å‹çš„è‡ªåŠ¨æ³¨å…¥
def get_user(user_id: int, db: Session = Depends(get_db)):
    return db.query(User).filter(User.id == user_id).first()

# Django REST: åŸºäºç±»çš„æ‰‹åŠ¨æ³¨å…¥  
class UserViewSet(viewsets.ModelViewSet):
    def get_queryset(self):
        return User.objects.all()

# Flask: æ‰‹åŠ¨ä¾èµ–ç®¡ç†
@app.route('/users/<int:user_id>')
def get_user(user_id):
    db = get_db()  # æ‰‹åŠ¨è·å–
    return db.query(User).filter(User.id == user_id).first()
```

**FastAPIä¼˜åŠ¿**ï¼š
- **é›¶å­¦ä¹ æˆæœ¬**ï¼šæ ‡å‡†å‡½æ•°ç­¾åå³ä¾èµ–å£°æ˜
- **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æ—¶æ£€æŸ¥ä¾èµ–ç±»å‹åŒ¹é…
- **è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜**ï¼šä¾èµ–å›¾è‡ªåŠ¨æ„å»ºå’Œè§£æ

#### 2. APIæ–‡æ¡£ç”Ÿæˆå¯¹æ¯”
```python
# FastAPI: å®Œå…¨è‡ªåŠ¨åŒ–
@app.get("/users/{user_id}", response_model=UserResponse)
def get_user(user_id: int) -> UserResponse:
    """è‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„OpenAPIæ–‡æ¡£"""
    pass

# Django REST: åŠè‡ªåŠ¨åŒ–
class UserViewSet(viewsets.ModelViewSet):
    """éœ€è¦é¢å¤–é…ç½®swagger_auto_schemaè£…é¥°å™¨"""
    serializer_class = UserSerializer
    queryset = User.objects.all()

# Flask: æ‰‹åŠ¨ç¼–å†™
@app.route('/users/<int:user_id>')
def get_user(user_id):
    """éœ€è¦ä½¿ç”¨flask-restxç­‰æ‰©å±•æ‰‹åŠ¨ç¼–å†™æ–‡æ¡£"""
    pass
```

### æ€§èƒ½æ¶æ„å¯¹æ¯”

#### è¯·æ±‚å¤„ç†æ€§èƒ½å¯¹æ¯”
```
åŸºå‡†æµ‹è¯• (req/s):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ¡†æ¶      â”‚   åŒæ­¥     â”‚    å¼‚æ­¥      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FastAPI     â”‚   ~8,000   â”‚   ~20,000    â”‚
â”‚ Django REST â”‚   ~3,000   â”‚   ~7,000     â”‚  
â”‚ Flask       â”‚   ~5,000   â”‚   ~12,000    â”‚
â”‚ Express.js  â”‚   ~15,000  â”‚   ~25,000    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ€§èƒ½ä¼˜åŠ¿æ¥æº**ï¼š
1. **ASGIåŸç”Ÿæ”¯æŒ**ï¼šçœŸæ­£çš„å¼‚æ­¥I/Oå¤„ç†
2. **StarletteåŸºç¡€**ï¼šé«˜åº¦ä¼˜åŒ–çš„HTTPå¤„ç†  
3. **Pydanticä¼˜åŒ–**ï¼šCæ‰©å±•çš„æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–
4. **å‡å°‘æŠ½è±¡å±‚**ï¼šç›´æ¥çš„è¯·æ±‚â†’å“åº”æ˜ å°„

---

## ğŸ”® æ¶æ„æ¼”è¿›è¶‹åŠ¿ä¸æ‰©å±•æ€§

### ç°æœ‰æ‰©å±•æœºåˆ¶åˆ†æ

#### 1. ä¸­é—´ä»¶æ‰©å±•ç‚¹
```python
# æ ‡å‡†ASGIä¸­é—´ä»¶åè®®
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
)

# è‡ªå®šä¹‰ä¸­é—´ä»¶
class TimingMiddleware(BaseHTTPMiddleware):
    async def dispatch(self, request, call_next):
        start_time = time.time()
        response = await call_next(request)
        process_time = time.time() - start_time
        response.headers["X-Process-Time"] = str(process_time)
        return response
```

#### 2. ä¾èµ–æ³¨å…¥æ‰©å±•ç‚¹
```python
# å…¨å±€ä¾èµ–
app = FastAPI(dependencies=[Depends(verify_token)])

# è·¯ç”±çº§åˆ«ä¾èµ–
@app.get("/admin/", dependencies=[Depends(verify_admin)])
def admin_endpoint():
    pass

# ä¾èµ–è¦†ç›– (æµ‹è¯•å‹å¥½)
app.dependency_overrides[get_db] = get_test_db
```

#### 3. å¼‚å¸¸å¤„ç†æ‰©å±•ç‚¹
```python
@app.exception_handler(CustomException)
async def custom_exception_handler(request, exc):
    return JSONResponse(
        status_code=418,
        content={"message": f"Custom error: {exc.detail}"}
    )
```

### æœªæ¥æ¶æ„æ¼”è¿›æ–¹å‘

#### 1. å¾®æœåŠ¡é›†æˆå¢å¼º
- **æœåŠ¡å‘ç°**ï¼šé›†æˆConsulã€Eurekaç­‰æœåŠ¡å‘ç°æœºåˆ¶
- **è´Ÿè½½å‡è¡¡**ï¼šå†…ç½®å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡æ”¯æŒ
- **åˆ†å¸ƒå¼è¿½è¸ª**ï¼šOpenTelemetryæ·±åº¦é›†æˆ

#### 2. äº‘åŸç”Ÿç‰¹æ€§
- **å®¹å™¨ä¼˜åŒ–**ï¼šæ›´å°çš„é•œåƒå°ºå¯¸å’Œå¯åŠ¨æ—¶é—´
- **å¥åº·æ£€æŸ¥**ï¼šæ ‡å‡†åŒ–çš„å¥åº·æ£€æŸ¥ç«¯ç‚¹
- **é…ç½®ç®¡ç†**ï¼šConfigMapå’ŒSecretçš„åŸç”Ÿæ”¯æŒ

#### 3. AI/MLå·¥å…·é“¾é›†æˆ
- **æ¨¡å‹æœåŠ¡åŒ–**ï¼šæœºå™¨å­¦ä¹ æ¨¡å‹çš„è‡ªåŠ¨REST APIåŒ…è£…
- **å‘é‡æ•°æ®åº“é›†æˆ**ï¼šå‘é‡æœç´¢å’Œç›¸ä¼¼æ€§è®¡ç®—æ”¯æŒ
- **æµå¼å“åº”**ï¼šå¤§æ¨¡å‹æµå¼è¾“å‡ºçš„åŸç”Ÿæ”¯æŒ

---

## ğŸ“ˆ æ¶æ„æˆç†Ÿåº¦è¯„ä¼°

### æŠ€æœ¯æˆç†Ÿåº¦æŒ‡æ ‡
```yaml
æ¶æ„ç¨³å®šæ€§: â­â­â­â­â­  (åŸºäºStarletteæˆç†ŸåŸºç¡€)
ç”Ÿæ€å®Œæ•´æ€§: â­â­â­â­â˜†  (å¿«é€Ÿå¢é•¿çš„æ’ä»¶ç”Ÿæ€)
æ€§èƒ½è¡¨ç°:   â­â­â­â­â­  (ASGI + å¼‚æ­¥çš„æ€§èƒ½ä¼˜åŠ¿)
å¼€å‘ä½“éªŒ:   â­â­â­â­â­  (ç±»å‹æç¤º + è‡ªåŠ¨æ–‡æ¡£)
å­¦ä¹ æˆæœ¬:   â­â­â­â­â˜†  (Pythonå¼€å‘è€…å‹å¥½)
ä¼ä¸šé‡‡ç”¨:   â­â­â­â­â˜†  (Netflix, Uberç­‰å¤§å‚ä½¿ç”¨)
```

### æ¶æ„ä¼˜åŠ¿æ€»ç»“
1. **æŠ€æœ¯å‰ç»æ€§**ï¼šåŸºäºç°ä»£Pythonç‰¹æ€§å’ŒASGIæ ‡å‡†
2. **å¼€å‘æ•ˆç‡**ï¼šæ˜¾è‘—å‡å°‘æ ·æ¿ä»£ç å’Œé…ç½®éœ€æ±‚  
3. **æ€§èƒ½å“è¶Š**ï¼šåœ¨Python Webæ¡†æ¶ä¸­æ€§èƒ½é¢†å…ˆ
4. **ç”Ÿæ€å…¼å®¹**ï¼šä¸ç°æœ‰Pythonç”Ÿæ€æ— ç¼é›†æˆ
5. **æ ‡å‡†éµå¾ª**ï¼šä¸¥æ ¼éµå¾ªOpenAPIå’ŒJSON Schemaæ ‡å‡†

### åº”ç”¨åœºæ™¯é€‚é…æ€§
- **âœ… å¼ºçƒˆæ¨è**ï¼šAPIæœåŠ¡ã€å¾®æœåŠ¡æ¶æ„ã€æœºå™¨å­¦ä¹ æœåŠ¡
- **âœ… é€‚åˆ**ï¼šä¸­å°å‹Webåº”ç”¨ã€åŸå‹å¼€å‘ã€å†…éƒ¨å·¥å…·
- **âš ï¸ è€ƒè™‘**ï¼šå¤§å‹å•ä½“åº”ç”¨ã€éœ€è¦å¤æ‚æ¨¡æ¿æ¸²æŸ“çš„Webåº”ç”¨
- **âŒ ä¸å»ºè®®**ï¼šä¼ ç»ŸWebåº”ç”¨ã€éœ€è¦å¤æ‚ORMçš„åº”ç”¨

---

*é€šè¿‡è¿™ä¸ªæ¶æ„å…¨æ™¯åˆ†æï¼Œæˆ‘ä»¬å»ºç«‹äº†å¯¹FastAPIæŠ€æœ¯ä½“ç³»çš„å®Œæ•´è®¤çŸ¥æ¡†æ¶ã€‚æ¥ä¸‹æ¥çš„åˆ†ç‰‡å°†æ·±å…¥åˆ°å…·ä½“çš„æŠ€æœ¯å®ç°ç»†èŠ‚ï¼Œç‰¹åˆ«æ˜¯å…¶æ ¸å¿ƒåˆ›æ–°â€”â€”ä¾èµ–æ³¨å…¥ç³»ç»Ÿçš„æ·±åº¦è§£æã€‚*

**æ–‡æ¡£ç‰¹è‰²**ï¼šæ¶æ„é©±åŠ¨ + è®¾è®¡ç†å¿µæ·±å…¥ + æŠ€æœ¯å¯¹æ¯”åˆ†æ  
**åˆ›å»ºæ—¶é—´**ï¼š2025å¹´1æœˆ  
**åˆ†ææ·±åº¦**ï¼šL1å±‚(å…¨æ™¯) + L4å±‚(è®¾è®¡ç†å¿µ) èåˆ